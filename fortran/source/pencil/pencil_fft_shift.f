!------------------------------------------------------------------------------!
!  
!  File:         fft_shift.cpp

!  Description:  Performs an fft shifting of the pencil arrays
!  
!------------------------------------------------------------------------------!
SUBROUTINE pencil_fft_shift( pen )

IMPLICIT NONE

!------------------------------------------------------------------------------!
! Arguments
!------------------------------------------------------------------------------!
	TYPE(class_pencil), INTENT(INOUT) :: pen

!------------------------------------------------------------------------------!
! Parameters
!------------------------------------------------------------------------------!

!------------------------------------------------------------------------------!
! Local variables
!------------------------------------------------------------------------------!
	INTEGER :: i

!------------------------------------------------------------------------------!
! Objects
!------------------------------------------------------------------------------!

!------------------------------------------------------------------------------!
! Set fft size
!------------------------------------------------------------------------------!

!------------------------------------------------------------------------------!
! Re-size fft vectors
!------------------------------------------------------------------------------!
	DO i = 0,pen%nfft/2-1
		IF ( pen%bX ) THEN
			pen%auxX(i) = pen%X(i)
			pen%X(i) = pen%X(i+pen%nfft/2)
		END IF
		IF ( pen%bY ) THEN
			pen%auxY(i) = pen%Y(i)
			pen%Y(i) = pen%Y(i+pen%nfft/2)
		END IF
		IF ( pen%bZ ) THEN
			pen%auxZ(i) = pen%Z(i)
			pen%Z(i) = pen%Z(i+pen%nfft/2)
		END IF
	END DO

	DO i = pen%nfft/2,pen%nfft-1
		IF ( pen%bX ) THEN
			pen%X(i) = pen%auxX(i-pen%nfft/2)
		END IF
		IF ( pen%bY ) THEN
			pen%Y(i) = pen%auxY(i-pen%nfft/2)
		END IF
		IF ( pen%bZ ) THEN
			pen%Z(i) = pen%auxZ(i-pen%nfft/2)
		END IF
	END DO

!------------------------------------------------------------------------------!
! Return
!------------------------------------------------------------------------------!
9999 CONTINUE

RETURN
END SUBROUTINE pencil_fft_shift
